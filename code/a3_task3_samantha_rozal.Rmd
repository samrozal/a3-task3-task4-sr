---
title: "a3_task3_samantha_rozal"
author: "Sam Rozal"
date: "10/24/2021"
output: html_document
---
# Setup
```{r setup, include=TRUE, message=FALSE, warning=FALSE}
knitr::opts_chunk$set(echo = TRUE, message=FALSE, warning= FALSE)
#attach packages
library(here)
library(tidyverse)
library(janitor)
library(DT)
library(plotly)
library(lubridate)
library(kableExtra)
```

# Read In the Data 
```{r}
#read in urchin data using read_csv

urchins <- read_csv(here("data", "urchins.csv"))

```

# Section 1
Size Comparison of purple and red urchins

## Data Visulaization
Compare distribution of sizes between red and purple urchins with a histogram 

### Data Wrangling: 
Clean names using clean_names()function
```{r}
urchins_clean <- clean_names(urchins)
```

### Data Visulaiztaion:
A histogram is created in ggplot to compare the different size distribution of red and purple urchins. This is completed using the `facet_wrap()` function to separate out by urchin type in the histograms. 
```{r, fig.cap= "Figure 1. **Comprison of size distribution between Red and Purple Urchins.** Red Urchin size distribution is more normally distributed than that of Purple Urchin size distribution. The size distribution of Purple Urchins is skewed toward lower values in comaprision to the size distribution of Red Urchins, indicating that, on average, Purple Urchins are larger than Red Urchins."}
ggplot(data=urchins_clean, aes(x=size)) +
  geom_histogram(aes(fill=common_name))+
  facet_wrap(~common_name) +
  labs(x="Urchin Diameter (cm)", 
       y= "Urchin Count", 
       title= "Distribution of Purple and Red Urchin Sizes")+
  theme_bw()

```

### Descriptive Statistics Table

A summary table is created using the `group_by()` and `summarize()` function for the mean, median, standard deviation, and sample size for both red and purple urchins. 
```{r}
urchins_summary <- urchins_clean %>% 
  group_by(common_name) %>%
  summarize(mean_urchin_size = round(mean(size, na.rm=TRUE), 2),
            median_urchin_size = median(size, na.rm=TRUE),
            sd_urchin_size = round(sd(size, na.rm=TRUE),2),
            urchin_sample_size = n())
urchins_summary 

```

Create and return a really awesomely formatted table using the `kableExtra` package. This is completed by using the `kable()` function and the `urchin_summary` data frame created in the last step
```{r, tab.caption= "Yay urchins"}
kable(urchins_summary,col.names=c("Common Name", 
                            "Mean Urchin Size (cm)", 
                            "Median Urchin Size (cm)", 
                            "Standard Deviation (cm)",
                            "Sample Size(n)"),caption= "Table 1: Summary Statistics for Purple and Red Urchins") %>% 
  kable_styling() #kable_styling() package formats the table to be nicer
```


Section iii of Section 1-- I need to add a 2-3 sentence description...



# Section 2

### Explore purple urchin counts by site and year
Create a subset entitled `purple_urchins` by filtering only for purple urchins using the `filter()` function and convert the date class to "Date"
```{r}
purple_urchins <- urchins_clean %>%
  filter(common_name == "Purple Urchin") %>% 
  mutate(new_date=mdy(date)) %>%
  mutate(year_new = year(new_date)) %>%
  mutate(site_full = case_when(
    site == "NAPL" ~ "Naples Reef",
    site == "AQUE" ~ "Arroyo Quemado Reef",
    site == "CARP" ~ "Carpinteria Reef",
    site == "MOHK" ~ "Mohawk Reef",
    site == "IVEE" ~ "Isla Vista Reef"
  ))

class(purple_urchins$new_date)
```

A data frame, called `purple_urchin_total` is creted using the` group_by()` and `summarize()` functions to store table that has the total number of purple urchins observed by site and year. 
```{r}
purple_urchins_total <- purple_urchins %>%
  group_by(site_full,year_new) %>% 
  summarize(count=n())
    
purple_urchins_total
```
# Data Visulaization 
A finalized graph of counts of purple urchins recorded at each site is created in ggplot using the geom_line() function
```{r, fig.caption= "**Figure 2. Number of Urchins present at Arroyo Quemado Reef, Carpinteria Reef, Isla Vista Reef, Mohawk Reef, and Naples Reef bewteeen the years of 2007 and 2020.** The number of Urchins observed incresed drastically betwen the year of 2008 and 2009, but has decresed at varying rates and intervals since. Specificaly,there was a sharp decrease in the observed urchins between the years of 2012 and 2013 along with between the years of 2019 and 2020." }
ggplot(data= purple_urchins_total, aes(x= year_new,y=count)) +
  geom_line(aes(color=site_full, na.rm=TRUE))+
  scale_x_continuous(breaks= seq(from = 2007, to= 2020,by=1)) +
  labs(x="Year",
       y= "Urchin count",
       title= "Urchins count by Size(cm) and year(2007-2020)",
       color="Site") 
  
```
I do not think that 
